{
    // See https://go.microsoft.com/fwlink/?LinkId=733558
    // for the documentation about the tasks.json format
    "version": "2.0.0",
    "tasks": [
        {
            "label": "3.0 build front",
            "type": "shell",
            "command": "sudo make js-deps js-build"
        },
        {
            "label": "3.1 build release v1.1.0",
            "type": "shell",
            "command": "sudo make build-release VERBOSE=2 CHANNEL='development' VERSION='v1.1.0' ARCH='amd64 arm64' OS='linux' SIGN='0' FRONTEND_PREBUILT='1'"
        },
        {
            "label": "3.2 docker build release",
            "type": "shell",
            "command": "make build-docker VERBOSE=2 CHANNEL='development' VERSION='v1.1.0' ARCH='amd64 arm64' DOCKER_IMAGE_NAME='adguardprivate:v1.1.0' DOCKER_OUTPUT='type=image'"
        },
        {
            "label": "1.0 build",
            "type": "shell",
            "command": "sudo make build VERBOSE=2 "
        },
        {
            "label": "1.1 build front",
            "type": "shell",
            "command": "sudo make js-build VERBOSE=2 "
        },
        {
            "label": "1.2 build AdguardHome",
            "type": "shell",
            "command": "sudo make go-build VERBOSE=2 CHANNEL='development' VERSION='v1.1.0' ARCH='amd64' OS='linux' SIGN='0'"
        },
        {
            "label": "1.3 quick build",
            "type": "shell",
            "command": "sudo make quick-build VERBOSE=2 "
        },
        {
            "label": "1.4 run AdguardHome",
            "type": "shell",
            "command": "sudo ./AdGuardHome -c AdGuardHome.yaml -w ./data --web-addr 0.0.0.0:50005 --local-frontend --no-check-update"
        },
        {
            "label": "Debug: tools/q",
            "type": "shell",
            "command": "./tools/q -s 127.0.0.1:5353 -t A -w -q baidu.com"
        },
        {
            "label": "4.1 push to aliyuncs/adguardprivate/adguardprivate:base",
            "type": "shell",
            "command": "docker buildx build --platform linux/amd64,linux/arm64 -f docker/Dockerfile.base -t registry.cn-hangzhou.aliyuncs.com/adguardprivate/adguardprivate:base . --push"
        },
        {
            "label": "4.2 update dist docker",
            "type": "shell",
            "command": "cp -f dist/AdGuardHome_linux_amd64/AdGuardHome/AdGuardHome dist/docker/AdGuardHome_linux_amd64_ && cp -f dist/AdGuardHome_linux_arm64/AdGuardHome/AdGuardHome dist/docker/AdGuardHome_linux_arm64_",
        },
        {
            "label": "4.3 push to aliyuncs/adguardprivate/adguardprivate:public_dev",
            "type": "shell",
            "command": "docker buildx build --platform linux/amd64,linux/arm64 -f docker/Dockerfile.quick -t registry.cn-hangzhou.aliyuncs.com/adguardprivate/adguardprivate:public_dev . --push",
            "dependsOrder": "sequence",
            "dependsOn": [
                "3.0 build front",
                "3.1 build release v1.1.0",
                "4.2 update dist docker"
            ]
        },
        {
            "label": "4.3 push to aliyuncs/adguardprivate/adguardprivate:public_latest",
            "type": "shell",
            "command": "docker buildx build --platform linux/amd64,linux/arm64 -f docker/Dockerfile.quick -t registry.cn-hangzhou.aliyuncs.com/adguardprivate/adguardprivate:public_latest . --push",
            "dependsOn": [
                // "3.0 build front",
                "3.1 build release v1.1.0",
                "4.2 update dist docker"
            ]
        }
    ]
}